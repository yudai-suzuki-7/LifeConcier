<div class="row mx-3" style="margin-top: 26px;">
    <h1>ToDo List
    </h1>
</div>
<div class="row mx-3">
    <%= render 'layouts/error', error: @todo %>
    <div class="todo-add-form">
        <%= form_for(@todo,url: todos_path) do |form| %>
        <span class="todo-text">
            <%= form.text_field :todo_text, style:"height:30px; width:300px;" %>
        </span>
        <span class="submit">
            <%= form.submit('追加',class: "btn btn-secondary btn-sm") %>
        </span>
        <% end %>
    </div>
    <table id="sortable-table" class="todo_list table table-striped mt-3">
        <thead>
            <tr>
                <th></th>
                <th></th>
                <th class="head-text text-center">Check</th>
                <th class="head-text text-center">Task</th>
                <th class="head-text text-center">編集</th>
                <th class="head-text text-center">消去</th>
            </tr>
        </thead>
        <tbody>
            <% @todos.each do |todo| %>
                <%= render 'todo_list', todo: todo %>
            <% end %>
        </tbody>
    </table>
</div>

<script>
// table_sort.js
$(function() {
  return $('.table-sortable').sortable({
    axis: 'y',
    items: '.sentence',
    update: function() {
    // ajax処理で並べ替え後の値をサーバー側に渡す
      $.ajax({
        type: 'POST',
        url: '/sort',
        dataType: 'json',
        // $('.table-sortable').sortable('serialize') で変更後の値を取得
        data: $('.table-sortable').sortable('serialize')
      });
    },
  });
});
</script>